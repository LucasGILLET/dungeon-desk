<script setup lang="ts">
defineProps<{
  subCategory: 'attack' | null;
}>();

defineEmits<{
  (e: 'open-sub-category', value: 'attack'): void;
}>();
</script>

<template>
  <Transition
    mode="out-in"
    enter-active-class="transition duration-300 ease-out"
    enter-from-class="translate-y-8 opacity-0"
    enter-to-class="translate-y-0 opacity-100"
    leave-active-class="transition duration-200 ease-in"
    leave-from-class="translate-y-0 opacity-100"
    leave-to-class="-translate-y-8 opacity-0"
  >
    <!-- VUE PRINCIPALE ACTION -->
    <div v-if="!subCategory" key="menu" class="space-y-6">
        <p class="text-center text-zinc-400 italic mb-4">
        Choisis <strong class="text-white">une seule</strong> option par tour.
        </p>

        <div class="space-y-3">
        <!-- ATTAQUE (Bouton Cliquable) -->
        <button 
            @click="$emit('open-sub-category', 'attack')"
            class="w-full text-left bg-zinc-900 border border-emerald-500/50 rounded-xl p-4 hover:bg-zinc-800 transition-all active:scale-95 group relative overflow-hidden"
        >
            <div class="flex items-center justify-between mb-1 relative z-10">
                <div class="flex items-center gap-3">
                    <span class="bg-emerald-500/10 p-2 rounded text-xl group-hover:bg-emerald-500/20 transition-colors">âš”ï¸</span>
                    <h3 class="font-bold text-emerald-400 text-lg uppercase group-hover:text-emerald-300">Attaquer</h3>
                </div>
                <span class="text-emerald-500/50 group-hover:text-emerald-400 group-hover:translate-x-1 transition-all">â”</span>
            </div>
              <p class="text-xs text-zinc-400 pl-[3.25rem] relative z-10">
                Clique pour voir les jets de dÃ©s et dÃ©tails.
            </p>
            <!-- Background effect -->
            <div class="absolute right-[-20px] bottom-[-20px] text-8xl opacity-5 group-hover:opacity-10 transition-opacity rotate-12 pointer-events-none">âš”ï¸</div>
        </button>

        <!-- LANCER UN SORT -->
        <div class="bg-black/40 border border-zinc-700 rounded-xl p-4">
            <div class="flex items-center gap-3 mb-2">
            <span class="bg-zinc-800 p-2 rounded text-xl">ğŸª„</span>
            <h3 class="font-bold text-zinc-200 text-lg uppercase">Lancer un sort</h3>
            </div>
              <p class="text-xs text-zinc-400">
            VÃ©rifie que le temps d'incantation est bien <strong class="text-white">"1 Action"</strong>.
            </p>
        </div>

        <!-- GRILLE AUTRES ACTIONS -->
        <div class="grid grid-cols-2 gap-3">
            <div class="bg-zinc-800/50 p-3 rounded-lg border border-zinc-700/50">
                <strong class="block text-emerald-400 mb-1">ğŸ›¡ï¸ Esquiver</strong>
                <p class="text-xs text-zinc-400">Vous vous tenez prÃªt Ã  esquiver les attaques ennemis. Pendant ce tour, les ennemis ont un dÃ©savantage pour vous attaquer, et vous Ãªtes avanatgÃ©s sur vos jets de sauvegarde de dextÃ©ritÃ©.</p>
            </div>
            <div class="bg-zinc-800/50 p-3 rounded-lg border border-zinc-700/50">
                <strong class="block text-emerald-400 mb-1">ğŸ” Chercher</strong>
                <p class="text-xs text-zinc-400">Vous effectuez un test de Perception ou d'Investigation pour trouver quelque chose.</p>
            </div>
            <div class="bg-zinc-800/50 p-3 rounded-lg border border-zinc-700/50">
                <strong class="block text-emerald-400 mb-1">ğŸ«£ Se dÃ©sengager</strong>
                <p class="text-xs text-zinc-400">Votre dÃ©placement ne provoque pas d'attaque d'opportunitÃ© pendant ce tour.</p>
            </div>
            <div class="bg-zinc-800/50 p-3 rounded-lg border border-zinc-700/50">
                <strong class="block text-emerald-400 mb-1">ğŸ’¨ Foncer</strong>
                <p class="text-xs text-zinc-400">Vous doublez votre vitesse de dÃ©placement pour ce tour.</p>
            </div>
            <div class="bg-zinc-800/50 p-3 rounded-lg border border-zinc-700/50">
                <strong class="block text-emerald-400 mb-1">ğŸ¤ Aider</strong>
                <p class="text-xs text-zinc-400">Vous assistez une crÃ©ature proche dans sa tÃ¢che, lui donnant un avantage sur celle-ci.</p>
            </div>
            <div class="bg-zinc-800/50 p-3 rounded-lg border border-zinc-700/50">
                <strong class="block text-emerald-400 mb-1">ğŸ«£ Se cacher</strong>
                <p class="text-xs text-zinc-400">Vous effectuez un test de DiscrÃ©tion pour tenter de vous cacher de vos ennemis.</p>
            </div>
            <div class="bg-zinc-800/50 p-3 rounded-lg border border-zinc-700/50">
                <strong class="block text-emerald-400 mb-1">â³ Se tenir prÃªt</strong>
                <p class="text-xs text-zinc-400">Vous attendez des conditions spÃ©cifiques pour agir, retardant votre action et dÃ©clenchant celle-ci en rÃ©action Ã  un Ã©vÃ©nement.</p>
            </div>
            <div class="bg-zinc-800/50 p-3 rounded-lg border border-zinc-700/50">
                <strong class="block text-emerald-400 mb-1">ğŸ§ª Utiliser un objet</strong>
                <p class="text-xs text-zinc-400">Vous utilisez un objet non magique qui s'utilise au prix de votre action.</p>
            </div>
            <div class="bg-zinc-800/50 p-3 rounded-lg border border-zinc-700/50">
                <strong class="block text-emerald-400 mb-1">ğŸ§ª Utiliser un objet magique</strong>
                <p class="text-xs text-zinc-400">Vous utilisez un objet magique qui s'utilise au prix de votre action.</p>
            </div>
            <div class="bg-zinc-800/50 p-3 rounded-lg border border-zinc-700/50">
                <strong class="block text-emerald-400 mb-1">ğŸ§ª Utiliser une capacitÃ© spÃ©ciale</strong>
                <p class="text-xs text-zinc-400">Vous utilisez une aptitude de classe ou autre capacitÃ© spÃ©ciale qui s'utilise au prix d'une action.</p>
            </div>
        </div>
        </div>
    </div>

    <!-- SOUS-CATEGORIE: DETAILS ATTAQUE -->
    <div v-else-if="subCategory === 'attack'" key="attack" class="space-y-6">
        <div class="bg-emerald-900/10 border border-emerald-500/30 p-4 rounded-xl text-center">
            <h3 class="font-serif font-bold text-emerald-400 text-xl mb-4">La SÃ©quence d'Attaque</h3>
            
            <div class="space-y-4">
                <!-- Ã‰TAPE 1 -->
                <div class="relative bg-zinc-900/50 p-4 rounded-lg border border-zinc-700">
                    <span class="absolute -top-3 -left-3 bg-emerald-600 w-8 h-8 flex items-center justify-center rounded-full font-bold text-white border-2 border-zinc-900">1</span>
                    <h4 class="font-bold text-white mb-2">Jet d'Attaque (Toucher)</h4>
                    <p class="text-xs text-zinc-400 mb-3">Est-ce que je touche l'armure ?</p>
                    <div class="bg-black/50 p-2 rounded text-emerald-300 font-mono text-sm border border-emerald-500/20 inline-block">
                        1d20 + Bonus d'Attaque
                    </div>
                    <div class="mt-2 text-xs text-zinc-500">
                        VS <span class="text-yellow-500 font-bold">CA</span> (Classe d'Armure) cible
                    </div>
                </div>

                <div class="text-zinc-600 text-xl font-bold">â¬‡ï¸ Si Ã§a touche â¬‡ï¸</div>

                <!-- Ã‰TAPE 2 -->
                <div class="relative bg-zinc-900/50 p-4 rounded-lg border border-zinc-700">
                      <span class="absolute -top-3 -left-3 bg-emerald-600 w-8 h-8 flex items-center justify-center rounded-full font-bold text-white border-2 border-zinc-900">2</span>
                    <h4 class="font-bold text-white mb-2">Jet de DÃ©gÃ¢ts (Blesser)</h4>
                    <p class="text-xs text-zinc-400 mb-3">Combien Ã§a fait mal ?</p>
                    <div class="bg-black/50 p-2 rounded text-red-300 font-mono text-sm border border-red-500/20 inline-block">
                        DÃ© de l'arme + Bonus Carac
                    </div>
                      <div class="mt-2 text-xs text-zinc-500">
                        (Ex: 1d8 + 3)
                    </div>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-3 mt-4">
            <div class="bg-zinc-800 p-3 rounded-lg text-center">
                <strong class="block text-emerald-400 text-sm mb-1">Critique (20 Nat)</strong>
                <p class="text-[10px] text-zinc-400">Touche auto. Double les dÃ©s (pas le bonus).</p>
            </div>
            <div class="bg-zinc-800 p-3 rounded-lg text-center">
                <strong class="block text-red-400 text-sm mb-1">Ã‰chec (1 Nat)</strong>
                <p class="text-[10px] text-zinc-400">Rate automatiquement.</p>
            </div>
        </div>

        <div class="bg-zinc-800/50 border border-zinc-700/50 p-4 rounded-xl">
            <h4 class="font-bold text-white text-sm mb-2">PortÃ©e & DÃ©savantage</h4>
            <ul class="text-xs text-zinc-400 space-y-2">
                <li>ğŸ›‘ <strong>Corps Ã  corps :</strong> Si tu tires Ã  distance avec un ennemi collÃ© Ã  toi, tu as le <span class="text-red-400">DÃ©savantage</span>.</li>
                <li>ğŸ¹ <strong>PortÃ©e longue :</strong> Tirer trÃ¨s loin (2e chiffre de la portÃ©e) = <span class="text-red-400">DÃ©savantage</span>.</li>
            </ul>
        </div>
    </div>
  </Transition>
</template>
